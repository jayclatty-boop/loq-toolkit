<wpfui:UiPage
    x:Class="LenovoLegionToolkit.WPF.Pages.DebloaterPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:LenovoLegionToolkit.WPF.Controls"
    xmlns:custom="clr-namespace:LenovoLegionToolkit.WPF.Controls.Custom"
    xmlns:utils="clr-namespace:LenovoLegionToolkit.WPF.Utils"
    xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Debloater"
    FlowDirection="{x:Static utils:LocalizationHelper.Direction}"
    Scrollable="True">

    <StackPanel Margin="0,0,16,12">

        <TextBlock
            Margin="0,16,0,24"
            AutomationProperties.Name="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
            Focusable="True"
            FontSize="24"
            FontWeight="Medium"
            Text="Debloater" />

        <custom:InfoBar
            x:Name="_disclaimerInfoBar"
            Margin="0,0,0,8"
            IsClosable="False"
            IsOpen="True"
            Severity="Warning"
            Title="Warning"
            Message="These tweaks modify Windows settings and may require administrator privileges. Use at your own risk." />

        <custom:CardControl Margin="0,0,0,8" Icon="Settings24">
            <custom:CardControl.Header>
                <controls:CardHeaderControl
                    Title="Options"
                    Subtitle="Restore point, preset profile, and bloatware scope." />
            </custom:CardControl.Header>

            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock VerticalAlignment="Center" Margin="0,0,12,0" Text="Profile" />
                    <ComboBox x:Name="_profileComboBox" MinWidth="260" SelectionChanged="ProfileComboBox_SelectionChanged" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock VerticalAlignment="Center" Margin="0,0,12,0" Text="Bloatware Scope" />
                    <ComboBox x:Name="_scopeComboBox" MinWidth="260" SelectionChanged="ScopeComboBox_SelectionChanged" />
                </StackPanel>

                <wpfui:ToggleSwitch
                    x:Name="_restorePointToggle"
                    Margin="0,0,0,8"
                    Content="Create a System Restore point before applying"
                    Click="RestorePointToggle_Click" />

                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                    <wpfui:SymbolIcon Symbol="Search24" Margin="0,0,8,0" VerticalAlignment="Center" />
                    <TextBlock VerticalAlignment="Center" Margin="0,0,8,0" Text="Search:" />
                    <wpfui:TextBox x:Name="_searchBox" MinWidth="300" Margin="0,0,12,0" TextChanged="SearchBox_TextChanged" />
                    <wpfui:Button Content="Refresh Status" Icon="ArrowSync24" Appearance="Secondary" Click="RefreshStatusButton_Click" />
                </StackPanel>

                <Grid Margin="0,12,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock x:Name="_statusText" Grid.Column="0" VerticalAlignment="Center" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />

                    <wpfui:Button
                        x:Name="_undoButton"
                        Grid.Column="1"
                        Margin="0,0,8,0"
                        Appearance="Secondary"
                        Content="Undo Selected"
                        Click="UndoButton_Click" />

                    <wpfui:Button
                        x:Name="_applyButton"
                        Grid.Column="2"
                        Appearance="Success"
                        Content="Apply Selected"
                        Click="ApplyButton_Click" />
                </Grid>
            </StackPanel>
        </custom:CardControl>

        <controls:LoadableControl x:Name="_loader" Visibility="Hidden" IndicatorVerticalAlignment="Center">
            <StackPanel x:Name="_categoriesPanel" />
        </controls:LoadableControl>

        <!-- Progress log area -->
        <custom:CardControl x:Name="_progressCard" Margin="0,8,0,0" Visibility="Collapsed" Icon="Info24">
            <custom:CardControl.Header>
                <controls:CardHeaderControl
                    Title="Progress"
                    Subtitle="Operation details" />
            </custom:CardControl.Header>
            <StackPanel>
                <ProgressBar x:Name="_progressBar" Margin="0,0,0,8" Height="4" IsIndeterminate="True" />
                <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                    <TextBlock x:Name="_progressLog" TextWrapping="Wrap" FontFamily="Consolas" FontSize="11" />
                </ScrollViewer>
            </StackPanel>
        </custom:CardControl>

    </StackPanel>
</wpfui:UiPage>
